# llia.synths.algo6.a3_data

from __future__ import print_function

from llia.program import Program
from llia.bank import ProgramBank
from llia.util.lmath import clip, db_to_amp
from llia.performance_edit import performance


prototype = {
    "amp" : 0.1,
    "port" : 0.0,
    "aToFreq" : 0,
    "brightness" : 1.0,
    "vfreq" : 5.0,
    "vdelay" : 0.0, # 0,4
    "vsens" : 0.1,
    "vdepth" : 0.0,
    "vibrato" : 0.0,
    
    "c1" : 1.0,
    "c1Enable" : 1.0,
    "c1Mix" : 1.0,
    
    "m1" : 1.0,
    "m1Bias" : 0,
    "aToMod1" : 0.0,
    "modDepth1" : 0.5,
    
    "envToMod1" : 1.0,
    "envMod1Lag" : 0.0,
    "m1Enable" : 1.0,
    
    "attack1" : 0.0,
    "decay1" : 0.0,
    "sustain1" : 1.0,
    "release1" : 0.0,
    
    "keyBreak1" : 60, 
    "c1LowKeyScale" : 0,
    "c1HighKeyScale" : 0,
    "m1LowKeyScale" : 0,
    "m1HighKeyScale" : 0,
    
    "c2" : 1.0,
    "c2Enable" : 1.0,
    "c2Mix" : 1.0,
    "m2" : 1.0,
    "m2Bias" : 0,
    "aToMod2" : 0.0,
    "modDepth2" : 0.5,
    "envToMod2" : 1.0,
    "envMod2Lag" : 0.0,
    "m2Enable" : 1.0,
    "attack2" : 0.0,
    "decay2" : 0.0,
    "sustain2" : 1.0,
    "release2" : 0.0,
    "keyBreak2" : 60,
    "c2LowKeyScale" : 0,
    "c2HighKeyScale" : 0,
    "m2LowKeyScale" : 0,
    "m2HighKeyScale" : 0,
    "fb3" : 0,
    "envToFb3" : 0,
    "c3" : 1.0,
    "c3Enable" : 1.0,
    "c3Mix" : 1.0,
    "m3" : 1.0,
    "m3Bias" : 0,
    "aToMod3" : 0.0,
    "modDepth3" : 0.5,
    "envToMod3" : 1.0,
    "envMod3Lag" : 0.0,
    "m3Enable" : 1.0,
    "attack3" : 0.0,
    "decay3" : 0.0,
    "sustain3" : 1.0,
    "release3" : 0.0,
    "keyBreak3" : 60,
    "c3LowKeyScale" : 0,
    "c3HighKeyScale" : 0,
    "m3LowKeyScale" : 0,
    "m3HighKeyScale" : 0}
    
class Algo6(Program):

    def __init__(self, name):
        super(Algo6, self).__init__(name, "Algo6", prototype)

program_bank = ProgramBank(Algo6("Init"))
program_bank.enable_undo = False

def _fill_vibrato(p, vmap):
    p["vfreq"] = max(0.001, float(vmap.get("freq", 4.0)))
    p["vdelay"] = max(0.0, float(vmap.get("depth", 0.0)))
    p["vsens"] = clip(float(vmap.get("sens", 0.1)), 0.0, 1.0)
    p["depth"] = clip(float(vmap.get("depth", 0.0)), 0.0, 1.0)


def _fill_carrier(p, n, cmap):
    p["c%d" % n] = abs(float(cmap.get("freq", 1.0)))
    if cmap.get("mute", False):
        enable = 0.0
    else:
        enable = 1.0
    p["c%dEnable" % n]  = enable
    p["c%dMix" % n] = db_to_amp(float(clip(cmap.get("mix", 0), 0, 1)))
    p["c%dLowKeyScale" % n] = int(cmap.get("lowScale", 0))
    p["c%dHighKeyScale" % n] = int(cmap.get("highScale", 0))
    
def _fill_modulator(p, n, mmap):
    p["m%d" % n] = abs(float(mmap.get("freq", 1.0)))
    if mmap.get("mute", False):
        enable = 0.0
    else:
        enable = 1.0
    p["m%dEnable" % n] = enable
    p["m%dBias" % n] = abs(int(mmap.get("bias", 0)))
    p["aToMod%d" % n] = float(mmap.get("a", 0.0))
    p["m%dLowKeyScale" % n] = int(mmap.get("lowScale", 0))
    p["m%dHighKeyScale" % n] = int(mmap.get("highScale", 0))
    if n == 3:
        p["fb3"] = abs(float(mmap.get("feedback", 0)))
        p["envToFb3"] = float(mmap.get("envToFeedbak", 0))

def _fill_break_keys(p, lst):
    acc = []
    for i in range(3):
        try:
            acc.append(int(clip(lst[i], 0, 127)))
        except IndexError:
            acc.append(60)
    p["keyBreak1"] = acc[0]
    p["keyBreak2"] = acc[1]
    p["keyBreak3"] = acc[2]


def _fill_adsr(p, n, lst):
    plst = ("attack", "decay", "sustain", "release")
    for i, prm in enumerate(plst):
        param = "%s%d" % (prm, n)
        if prm == "sustain":
            value = float(clip(lst[i], 0, 1))
        else:
            value = abs(float(lst[i]))
        p[param] = value
        
def algo6(slot, name, amp=-12,
          port = 0.0,
          aToFreq = 0.0,
          brightness = 1.0,
          vibrato = {"freq" : 5.0,
                     "delay" : 0.0,
                     "sens" : 0.1,
                     "depth" : 0.0},
          c1 = {"mute" : False,
                "freq" : 1.0,
                "mix" : 0,
                "lowScale" : 0,
                "highScale" : 0},
          m1 = {"mute" : False,
                "freq" : 1.0,
                "bias" : 0.0,
                "a" : 0.0,
                "modDepth" : 0.0,
                "env" : 1.0,
                "lag" : 0.0,
                "lowScale" : 0,
                "highScale" : 0},
          c2 = {"mute" : False,
                "freq" : 1.0,
                "mix" : -99,
                "lowScale" : 0,
                "highScale" : 0},
          m2 = {"mute" : False,
                "freq" : 1.0,
                "bias" : 0.0,
                "a" : 0.0,
                "modDepth" : 0.0,
                "env" : 1.0,
                "lag" : 0.0,
                "lowScale" : 0,
                "highScale" : 0},
          c3 = {"mute" : False,
                "freq" : 1.0,
                "mix" : -99,
                "lowScale" : 0,
                "highScale" : 0},
          m3 = {"mute" : False,
                "freq" : 1.0,
                "bias" : 0.0,
                "a" : 0.0,
                "modDepth" : 0.0,
                "env" : 1.0,
                "lag" : 0.0,
                "lowScale" : 0,
                "highScale" : 0,
                "feedback" : 0.0,
                "envToFeedback" : 0.0},
          break_keys = [60, 60, 60],
          env1 = [0.00, 0.00, 1.00, 0.00],
          env2 = [0.00, 0.00, 1.00, 0.00],
          env3 = [0.00, 0.00, 1.00, 0.00]):
    p = Algo6(name)
    p.performance = performance()
    p["amp"] = db_to_amp(amp)
    p["port"] = float(port)
    p["aToFreq"] = float(aToFreq)
    p["brightness"] = float(brightness)
    _fill_vibrato(p, vibrato)
    _fill_carrier(p, 1, c1)
    _fill_carrier(p, 2, c2)
    _fill_carrier(p, 3, c3)
    _fill_modulator(p, 1, m1)
    _fill_modulator(p, 2, m2)
    _fill_modulator(p, 3, m3)
    _fill_break_keys(p,break_keys)
    _fill_adsr(p, 1, env1)
    _fill_adsr(p, 2, env2)
    _fill_adsr(p, 3, env3)
    program_bank[slot] = p
    return p
          
# algo6(0, "Init", amp=-12,
#       port = 0.0,
#       aToFreq = 0.0,
#       brightness = 1.0,
#       vibrato = {"freq" : 5.0,
#                  "delay" : 0.0,
#                  "sens" : 0.1,
#                  "depth" : 0.0},
#       c1 = {"mute" : False,
#             "freq" : 1.0,
#             "mix" : 0,
#             "lowScale" : 0,
#             "highScale" : 0},
#       m1 = {"mute" : False,
#             "freq" : 1.0,
#             "bias" : 0.0,
#             "a" : 0.0,
#             "modDepth" : 0.0,
#             "env" : 1.0,
#             "lag" : 0.0},
#       c2 = {"mute" : False,
#             "freq" : 1.0,
#             "mix" : -99,
#             "lowScale" : 0,
#             "highScale" : 0},
#       m2 = {"mute" : False,
#             "freq" : 1.0,
#             "bias" : 0.0,
#             "a" : 0.0,
#             "modDepth" : 0.0,
#             "env" : 1.0,
#             "lag" : 0.0},
#       c3 = {"mute" : False,
#             "freq" : 1.0,
#             "mix" : -99,
#             "lowScale" : 0,
#             "highScale" : 0},
#       m3 = {"mute" : False,
#             "freq" : 1.0,
#             "bias" : 0.0,
#             "a" : 0.0,
#             "modDepth" : 0.0,
#             "env" : 1.0,
#             "lag" : 0.0,
#             "feedback" : 0.0,
#             "envToFeedback" : 0.0},
#       break_keys = [60, 60, 60],
#       env1 = [0.00, 0.00, 1.00, 0.00],
#       env2 = [0.00, 0.00, 1.00, 0.00],
#       env3 = [0.00, 0.00, 1.00, 0.00])


algo6(  0, "Random-0", amp=-12,
      port = 0.000,
      aToFreq = 0.0000,
      brightness = 0.473,
      vibrato = {"freq"  : 4.660,
                 "delay" : 0.000,
                 "sens"  : 0.010,
                 "depth" : 0.000},
      c1 = {"mute" : False,
            "freq" : 2.0000,
            "mix"  : 0.000,
            "lowScale"  : 0,
            "highScale" : 0},
      m1 = {"mute" : False,
            "freq" : 3.0000,
            "bias" : 2,
            "a"    : 0.0000,
            "env"  : 1.000,
            "lag"  : 0.000,
            "modDepth" : 0.500,
            "lowScale"  : 0,
            "highScale" : -9},
      c2 = {"mute" : False,
            "freq" : 5.0000,
            "mix"  : 0.000,
            "lowScale"  : 0,
            "highScale" : 0},
      m2 = {"mute" : False,
            "freq" : 5.0625,
            "bias" : 0,
            "a"    : 0.0000,
            "env"  : 1.000,
            "lag"  : 0.000,
            "modDepth" : 0.500,
            "lowScale"  : 0,
            "highScale" : -3},
      c3 = {"mute" : False,
            "freq" : 0.7500,
            "mix"  : 0.000,
            "lowScale"  : 0,
            "highScale" : 0},
      m3 = {"mute" : False,
            "freq" : 0.5000,
            "bias" : 0,
            "a"    : 0.0000,
            "env"  : 1.000,
            "lag"  : 0.000,
            "modDepth" : 0.500,
            "feedback" : 0.000,
            "envToFeedback" :  0.000,
            "lowScale"  : 3,
            "highScale" : 0},
      break_keys = [48, 60, 60],
      env1 = [0.000, 0.156, 0.088, 0.292],
      env2 = [0.000, 0.297, 0.149, 0.127],
      env3 = [0.000, 0.193, 0.002, 0.042])

algo6(  1, "Random-1", amp=-12,
      port = 0.000,
      aToFreq = 0.0000,
      brightness = 0.158,
      vibrato = {"freq"  : 4.000,
                 "delay" : 0.031,
                 "sens"  : 0.741,
                 "depth" : 0.000},
      c1 = {"mute" : True,
            "freq" : 2.0000,
            "mix"  : 0.000,
            "lowScale"  : 0,
            "highScale" : 0},
      m1 = {"mute" : True,
            "freq" : 6.0000,
            "bias" : 0,
            "a"    : 0.0000,
            "env"  : 1.000,
            "lag"  : 0.000,
            "modDepth" : 0.500,
            "lowScale"  : 0,
            "highScale" : -3},
      c2 = {"mute" : True,
            "freq" : 5.0000,
            "mix"  : 0.000,
            "lowScale"  : 0,
            "highScale" : 0},
      m2 = {"mute" : True,
            "freq" : 2.0000,
            "bias" : 0,
            "a"    : 0.0000,
            "env"  : 1.000,
            "lag"  : 0.000,
            "modDepth" : 0.500,
            "lowScale"  : 0,
            "highScale" : 0},
      c3 = {"mute" : True,
            "freq" : 1.0000,
            "mix"  : 0.000,
            "lowScale"  : 0,
            "highScale" : 0},
      m3 = {"mute" : True,
            "freq" : 2.9891,
            "bias" : 0,
            "a"    : 0.0000,
            "env"  : 1.000,
            "lag"  : 0.000,
            "modDepth" : 0.500,
            "feedback" : 0.000,
            "envToFeedback" :  0.000,
            "lowScale"  : 0,
            "highScale" : 0},
      break_keys = [60, 48, 48],
      env1 = [0.000, 5.609, 0.233, 2.396],
      env2 = [0.000, 5.609, 0.233, 2.396],
      env3 = [0.000, 5.609, 0.233, 2.396])

algo6(  2, "Random-2", amp=-12,
      port = 0.000,
      aToFreq = 0.0000,
      brightness = 1.000,
      vibrato = {"freq"  : 5.675,
                 "delay" : 0.618,
                 "sens"  : 0.010,
                 "depth" : 0.000},
      c1 = {"mute" : True,
            "freq" : 2.0000,
            "mix"  : 0.000,
            "lowScale"  : 0,
            "highScale" : 0},
      m1 = {"mute" : True,
            "freq" : 0.5000,
            "bias" : 1,
            "a"    : 0.0000,
            "env"  : 1.000,
            "lag"  : 0.000,
            "modDepth" : 0.500,
            "lowScale"  : 6,
            "highScale" : 0},
      c2 = {"mute" : True,
            "freq" : 3.0000,
            "mix"  : 0.000,
            "lowScale"  : 0,
            "highScale" : 0},
      m2 = {"mute" : True,
            "freq" : 5.0000,
            "bias" : 0,
            "a"    : 0.0000,
            "env"  : 1.000,
            "lag"  : 0.000,
            "modDepth" : 0.500,
            "lowScale"  : 0,
            "highScale" : -9},
      c3 = {"mute" : True,
            "freq" : 6.0000,
            "mix"  : 0.000,
            "lowScale"  : 0,
            "highScale" : 0},
      m3 = {"mute" : True,
            "freq" : 0.5000,
            "bias" : 0,
            "a"    : 0.0000,
            "env"  : 1.000,
            "lag"  : 0.000,
            "modDepth" : 0.500,
            "feedback" : 0.000,
            "envToFeedback" :  0.000,
            "lowScale"  : 3,
            "highScale" : 0},
      break_keys = [72, 48, 48],
      env1 = [3.657, 0.095, 0.907, 2.838],
      env2 = [3.657, 0.095, 0.907, 2.838],
      env3 = [3.657, 0.095, 0.907, 2.838])

algo6(  3, "Random-3", amp=-12,
      port = 0.000,
      aToFreq = 0.0000,
      brightness = 1.000,
      vibrato = {"freq"  : 4.978,
                 "delay" : 0.000,
                 "sens"  : 0.010,
                 "depth" : 0.000},
      c1 = {"mute" : True,
            "freq" : 8.0000,
            "mix"  : 0.000,
            "lowScale"  : 0,
            "highScale" : 0},
      m1 = {"mute" : True,
            "freq" : 2.6637,
            "bias" : 0,
            "a"    : 0.0000,
            "env"  : 1.000,
            "lag"  : 0.000,
            "modDepth" : 0.500,
            "lowScale"  : 0,
            "highScale" : 0},
      c2 = {"mute" : True,
            "freq" : 3.0000,
            "mix"  : 0.000,
            "lowScale"  : 0,
            "highScale" : 0},
      m2 = {"mute" : True,
            "freq" : 2.2433,
            "bias" : 0,
            "a"    : 0.0000,
            "env"  : 1.000,
            "lag"  : 0.000,
            "modDepth" : 0.500,
            "lowScale"  : 0,
            "highScale" : 0},
      c3 = {"mute" : True,
            "freq" : 0.5000,
            "mix"  : 0.000,
            "lowScale"  : 0,
            "highScale" : 0},
      m3 = {"mute" : True,
            "freq" : 0.2972,
            "bias" : 0,
            "a"    : 0.0000,
            "env"  : 1.000,
            "lag"  : 0.000,
            "modDepth" : 0.500,
            "feedback" : 0.000,
            "envToFeedback" :  0.000,
            "lowScale"  : 3,
            "highScale" : 0},
      break_keys = [60, 60, 60],
      env1 = [0.355, 0.351, 0.861, 0.929],
      env2 = [0.355, 0.351, 0.861, 0.929],
      env3 = [0.355, 0.351, 0.861, 0.929])

algo6(  4, "FM Bell 1", amp=-12,
      port = 0.000,
      aToFreq = 0.0000,
      brightness = 1.000,
      vibrato = {"freq"  : 4.214,
                 "delay" : 0.000,
                 "sens"  : 0.010,
                 "depth" : 0.000},
      c1 = {"mute" : True,
            "freq" : 0.7500,
            "mix"  : 0.000,
            "lowScale"  : 0,
            "highScale" : 0},
      m1 = {"mute" : True,
            "freq" : 5.0625,
            "bias" : 0,
            "a"    : 0.0000,
            "env"  : 1.000,
            "lag"  : 0.000,
            "modDepth" : 0.500,
            "lowScale"  : 0,
            "highScale" : -6},
      c2 = {"mute" : True,
            "freq" : 6.0000,
            "mix"  : 0.000,
            "lowScale"  : 0,
            "highScale" : 0},
      m2 = {"mute" : True,
            "freq" : 5.0625,
            "bias" : 0,
            "a"    : 0.0000,
            "env"  : 1.000,
            "lag"  : 0.000,
            "modDepth" : 0.500,
            "lowScale"  : 0,
            "highScale" : -9},
      c3 = {"mute" : True,
            "freq" : 2.0000,
            "mix"  : 0.000,
            "lowScale"  : 0,
            "highScale" : 0},
      m3 = {"mute" : True,
            "freq" : 6.0000,
            "bias" : 0,
            "a"    : 0.0000,
            "env"  : 1.000,
            "lag"  : 0.000,
            "modDepth" : 0.500,
            "feedback" : 0.000,
            "envToFeedback" :  0.000,
            "lowScale"  : 0,
            "highScale" : -9},
      break_keys = [60, 60, 72],
      env1 = [0.000, 2.215, 0.205, 7.058],
      env2 = [0.000, 2.215, 0.205, 7.058],
      env3 = [0.000, 2.215, 0.205, 7.058])

algo6(  5, "Random-5", amp=-12,
      port = 0.000,
      aToFreq = 0.0000,
      brightness = 0.587,
      vibrato = {"freq"  : 1.357,
                 "delay" : 0.000,
                 "sens"  : 0.010,
                 "depth" : 0.000},
      c1 = {"mute" : True,
            "freq" : 0.5000,
            "mix"  : 0.000,
            "lowScale"  : 0,
            "highScale" : 0},
      m1 = {"mute" : True,
            "freq" : 1.5000,
            "bias" : 5,
            "a"    : 0.0000,
            "env"  : 1.000,
            "lag"  : 0.000,
            "modDepth" : 0.500,
            "lowScale"  : 0,
            "highScale" : 0},
      c2 = {"mute" : True,
            "freq" : 8.0000,
            "mix"  : 0.000,
            "lowScale"  : 0,
            "highScale" : 0},
      m2 = {"mute" : True,
            "freq" : 0.5000,
            "bias" : 0,
            "a"    : 0.0000,
            "env"  : 1.000,
            "lag"  : 0.000,
            "modDepth" : 0.500,
            "lowScale"  : 3,
            "highScale" : 0},
      c3 = {"mute" : True,
            "freq" : 1.0000,
            "mix"  : 0.000,
            "lowScale"  : 0,
            "highScale" : 0},
      m3 = {"mute" : True,
            "freq" : 4.9601,
            "bias" : 3,
            "a"    : 0.0000,
            "env"  : 1.000,
            "lag"  : 0.000,
            "modDepth" : 0.500,
            "feedback" : 2.392,
            "envToFeedback" :  0.000,
            "lowScale"  : 0,
            "highScale" : -9},
      break_keys = [60, 60, 48],
      env1 = [0.000, 4.253, 0.043, 1.073],
      env2 = [0.000, 4.253, 0.043, 1.073],
      env3 = [0.000, 4.253, 0.043, 1.073])

algo6(  6, "Random-6", amp=-12,
      port = 0.000,
      aToFreq = 0.0000,
      brightness = 0.929,
      vibrato = {"freq"  : 1.039,
                 "delay" : 0.352,
                 "sens"  : 0.010,
                 "depth" : 0.000},
      c1 = {"mute" : True,
            "freq" : 0.5000,
            "mix"  : 0.000,
            "lowScale"  : 0,
            "highScale" : 0},
      m1 = {"mute" : True,
            "freq" : 0.2500,
            "bias" : 0,
            "a"    : 0.0000,
            "env"  : 1.000,
            "lag"  : 0.000,
            "modDepth" : 0.500,
            "lowScale"  : 9,
            "highScale" : 0},
      c2 = {"mute" : True,
            "freq" : 1.0026,
            "mix"  : 0.000,
            "lowScale"  : 0,
            "highScale" : 0},
      m2 = {"mute" : True,
            "freq" : 2.0000,
            "bias" : 0,
            "a"    : 0.0000,
            "env"  : 1.000,
            "lag"  : 0.000,
            "modDepth" : 0.500,
            "lowScale"  : 0,
            "highScale" : 0},
      c3 = {"mute" : True,
            "freq" : 0.5000,
            "mix"  : 0.000,
            "lowScale"  : 0,
            "highScale" : 0},
      m3 = {"mute" : True,
            "freq" : 0.5026,
            "bias" : 0,
            "a"    : 0.0000,
            "env"  : 1.000,
            "lag"  : 0.000,
            "modDepth" : 0.500,
            "feedback" : 0.000,
            "envToFeedback" :  0.000,
            "lowScale"  : 6,
            "highScale" : 0},
      break_keys = [72, 60, 48],
      env1 = [0.000, 6.901, 0.185, 1.794],
      env2 = [0.000, 6.901, 0.185, 1.794],
      env3 = [0.000, 6.901, 0.185, 1.794])

algo6(  7, "Random-7", amp=-12,
      port = 0.000,
      aToFreq = 0.0000,
      brightness = 1.000,
      vibrato = {"freq"  : 5.736,
                 "delay" : 0.000,
                 "sens"  : 0.010,
                 "depth" : 0.000},
      c1 = {"mute" : True,
            "freq" : 1.5000,
            "mix"  : 0.000,
            "lowScale"  : 0,
            "highScale" : 0},
      m1 = {"mute" : True,
            "freq" : 3.0000,
            "bias" : 0,
            "a"    : 0.0000,
            "env"  : 1.000,
            "lag"  : 0.000,
            "modDepth" : 0.500,
            "lowScale"  : 0,
            "highScale" : -6},
      c2 = {"mute" : True,
            "freq" : 3.0086,
            "mix"  : 0.000,
            "lowScale"  : 0,
            "highScale" : 0},
      m2 = {"mute" : True,
            "freq" : 5.0000,
            "bias" : 3,
            "a"    : 0.0000,
            "env"  : 1.000,
            "lag"  : 0.000,
            "modDepth" : 0.500,
            "lowScale"  : 0,
            "highScale" : -3},
      c3 = {"mute" : True,
            "freq" : 2.0000,
            "mix"  : 0.000,
            "lowScale"  : 0,
            "highScale" : 0},
      m3 = {"mute" : True,
            "freq" : 2.0000,
            "bias" : 0,
            "a"    : 0.0000,
            "env"  : 1.000,
            "lag"  : 0.000,
            "modDepth" : 0.500,
            "feedback" : 2.862,
            "envToFeedback" :  0.000,
            "lowScale"  : 0,
            "highScale" : 0},
      break_keys = [60, 60, 72],
      env1 = [5.021, 0.857, 0.646, 1.234],
      env2 = [5.021, 0.857, 0.646, 1.234],
      env3 = [5.021, 0.857, 0.646, 1.234])

